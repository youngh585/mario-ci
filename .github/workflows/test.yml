name: C Tests
on: [push, pull_request]

permissions:
  contents: read

jobs:
  test:
    runs-on: ubuntu-latest
    container:
      image: ubuntu:22.04
      options: --user 0        # <-- important
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Install C toolchain
        run: |
          apt-get update
          apt-get install -y clang make

      - name: Run tests
        run: bash scripts/run_tests.sh
